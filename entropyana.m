
pathin='D:\Dropbox\Batch2\Grating&CircleTestConcat\';
S=0;

if S==1 sn='g'; else sn='c'; end

% CO
for m=1:8
    
    c00=0;c01=0;c10=0;c11=0;c000=0;c001=0;c010=0;c011=0;c100=0;c101=0;c110=0;c111=0;
    c0000=0;c0001=0;c0010=0;c0011=0;c0100=0;c0101=0;c0110=0;c0111=0;c1000=0;c1001=0;c1010=0;c1011=0;c1100=0;c1101=0;c1110=0;c1111=0;
    
    mname=['mouse',num2str(m),'-CO','-',sn];
    filecheck=fopen([pathin,mname,'.mat'],'r');if filecheck<0 continue; else fclose(filecheck); end
    eval(['load ',pathin,mname,'.mat beamcross TS turncol imagecol nosepokecol -mat']);
    
    train=TS(:,3);
    p1=sum(train)/length(train);p0=1-p1;
    H1CO(m)=-(p1*log2(p1)+p0*log2(p0));
    
    for n=1:(length(train)-1)
        if train(n:(n+1))==[0;0]
            c00=c00+1;
        elseif train(n:(n+1))==[0;1]
            c01=c01+1;
        elseif train(n:(n+1))==[1;0]
            c10=c10+1;
        elseif train(n:(n+1))==[1;1]
            c11=c11+1;
        end
    end
    p00=c00/(c00+c01+c10+c11);
    p01=c01/(c00+c01+c10+c11);
    p10=c10/(c00+c01+c10+c11);
    p11=c11/(c00+c01+c10+c11);
    %     if p00==0 p00=1;end
    %     if p01==0 p01=1;end
    %     if p10==0 p10=1;end
    %     if p11==0 p11=1;end
    %    H2CO(m)=-(p00*log2(p00)+p01*log2(p01)+p10*log2(p10)+p11*log2(p11));
    
    for n=1:(length(train)-2)
        if train(n:(n+2))==[0;0;0]
            c000=c000+1;
        elseif train(n:(n+2))==[0;0;1]
            c001=c001+1;
        elseif train(n:(n+2))==[0;1;0]
            c010=c010+1;
        elseif train(n:(n+2))==[0;1;1]
            c011=c011+1;
        elseif train(n:(n+2))==[1;0;0]
            c100=c100+1;
        elseif train(n:(n+2))==[1;0;1]
            c101=c101+1;
        elseif train(n:(n+2))==[1;1;0]
            c110=c110+1;
        elseif train(n:(n+2))==[1;1;1]
            c111=c111+1;
        end
    end
    
    p000=c000/(c000+c001+c010+c011+c100+c101+c110+c111);
    p001=c001/(c000+c001+c010+c011+c100+c101+c110+c111);
    p010=c010/(c000+c001+c010+c011+c100+c101+c110+c111);
    p011=c011/(c000+c001+c010+c011+c100+c101+c110+c111);
    p100=c100/(c000+c001+c010+c011+c100+c101+c110+c111);
    p101=c101/(c000+c001+c010+c011+c100+c101+c110+c111);
    p110=c110/(c000+c001+c010+c011+c100+c101+c110+c111);
    p111=c111/(c000+c001+c010+c011+c100+c101+c110+c111);
    %     if p000==0 p000=1;end
    %     if p001==0 p001=1;end
    %     if p010==0 p010=1;end
    %     if p011==0 p011=1;end
    %     if p100==0 p100=1;end
    %     if p101==0 p101=1;end
    %     if p110==0 p110=1;end
    %     if p111==0 p111=1;end
    %    H3CO(m)=-(p000*log2(p000)+p001*log2(p001)+p010*log2(p010)+p011*log2(p011)+p100*log2(p100)+p101*log2(p101)+p110*log2(p110)+p111*log2(p111));
    
    for n=1:(length(train)-3)
        if train(n:(n+3))==[0;0;0;0]
            c0000=c0000+1;
        elseif train(n:(n+3))==[0;0;0;1]
            c0001=c0001+1;
        elseif train(n:(n+3))==[0;0;1;0]
            c0010=c0010+1;
        elseif train(n:(n+3))==[0;0;1;1]
            c0011=c0011+1;
        elseif train(n:(n+3))==[0;1;0;0]
            c0100=c0100+1;
        elseif train(n:(n+3))==[0;1;0;1]
            c0101=c0101+1;
        elseif train(n:(n+3))==[0;1;1;0]
            c0110=c0110+1;
        elseif train(n:(n+3))==[0;1;1;1]
            c0111=c0111+1;
        elseif train(n:(n+3))==[1;0;0;0]
            c1000=c1000+1;
        elseif train(n:(n+3))==[1;0;0;1]
            c1001=c1001+1;
        elseif train(n:(n+3))==[1;0;1;0]
            c1010=c1010+1;
        elseif train(n:(n+3))==[1;0;1;1]
            c1011=c1011+1;
        elseif train(n:(n+3))==[1;1;0;0]
            c1100=c1100+1;
        elseif train(n:(n+3))==[1;1;0;1]
            c1101=c1101+1;
        elseif train(n:(n+3))==[1;1;1;0]
            c1110=c1110+1;
        elseif train(n:(n+3))==[1;1;1;1]
            c1111=c1111+1;
        end
    end
    
    p0000=c0000/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0001=c0001/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0010=c0010/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0011=c0011/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0100=c0100/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0101=c0101/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0110=c0110/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0111=c0111/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1000=c1000/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1001=c1001/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1010=c1010/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1011=c1011/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1100=c1100/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1101=c1101/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1110=c1110/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1111=c1111/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    
    %     if p0000==0 p0000=1;end
    %     if p0001==0 p0001=1;end
    %     if p0010==0 p0010=1;end
    %     if p0011==0 p0011=1;end
    %     if p0100==0 p0100=1;end
    %     if p0101==0 p0101=1;end
    %     if p0110==0 p0110=1;end
    %     if p0111==0 p0111=1;end
    %     if p1000==0 p1000=1;end
    %     if p1001==0 p1001=1;end
    %     if p1010==0 p1010=1;end
    %     if p1011==0 p1011=1;end
    %     if p1100==0 p1100=1;end
    %     if p1101==0 p1101=1;end
    %     if p1110==0 p1110=1;end
    %     if p1111==0 p1111=1;end
    %    H4CO(m)=-(p0000*log2(p0000)+p0001*log2(p0001)+p0010*log2(p0010)+p0011*log2(p0011)+p0100*log2(p0100)+p0101*log2(p0101)+p0110*log2(p0110)+p0111*log2(p0111)...
    %       +p1000*log2(p1000)+p1001*log2(p1001)+p1010*log2(p1010)+p1011*log2(p1011)+p1100*log2(p1100)+p1101*log2(p1101)+p1110*log2(p1110)+p1111*log2(p1111));
    
    H4CO(m)=-((p0000+p1000+p0001+p0111+p1110+p1111+p0011+p1100)*log2(p0000+p1000+p0001+p0111+p1110+p1111+p0011+p1100)...
         +(p0010+p0100+p0110+p1010+p0101+p1001+p1011+p1101)*log2(p0010+p0100+p0110+p1010+p0101+p1001+p1011+p1101));
    
end


for m=1:8
    
    c00=0;c01=0;c10=0;c11=0;c11=0;c000=0;c001=0;c010=0;c011=0;c100=0;c101=0;c110=0;c111=0;
    c0000=0;c0001=0;c0010=0;c0011=0;c0100=0;c0101=0;c0110=0;c0111=0;c1000=0;c1001=0;c1010=0;c1011=0;c1100=0;c1101=0;c1110=0;c1111=0;
    
    mname=['mouse',num2str(m),'-SD','-',sn];
    filecheck=fopen([pathin,mname,'.mat'],'r');if filecheck<0 continue; else fclose(filecheck); end
    eval(['load ',pathin,mname,'.mat beamcross TS turncol imagecol nosepokecol -mat']);
    
    train=TS(:,3);
    p1=sum(train)/length(train);p0=1-p1;
    H1SD(m)=-(p1*log2(p1)+p0*log2(p0));
    
    for n=1:(length(train)-1)
        if train(n:(n+1))==[0;0]
            c00=c00+1;
        elseif train(n:(n+1))==[0;1]
            c01=c01+1;
        elseif train(n:(n+1))==[1;0]
            c10=c10+1;
        elseif train(n:(n+1))==[1;1]
            c11=c11+1;
        end
    end
    p00=c00/(c00+c01+c10+c11);
    p01=c01/(c00+c01+c10+c11);
    p10=c10/(c00+c01+c10+c11);
    p11=c11/(c00+c01+c10+c11);
    %     if p00==0 p00=1;end
    %     if p01==0 p01=1;end
    %     if p10==0 p10=1;end
    %     if p11==0 p11=1;end
    %     H2SD(m)=-(p00*log2(p00)+p01*log2(p01)+p10*log2(p10)+p11*log2(p11));
    
    
    
    for n=1:(length(train)-2)
        if train(n:(n+2))==[0;0;0]
            c000=c000+1;
        elseif train(n:(n+2))==[0;0;1]
            c001=c001+1;
        elseif train(n:(n+2))==[0;1;0]
            c010=c010+1;
        elseif train(n:(n+2))==[0;1;1]
            c011=c011+1;
        elseif train(n:(n+2))==[1;0;0]
            c100=c100+1;
        elseif train(n:(n+2))==[1;0;1]
            c101=c101+1;
        elseif train(n:(n+2))==[1;1;0]
            c110=c110+1;
        elseif train(n:(n+2))==[1;1;1]
            c111=c111+1;
        end
    end
    
    p000=c000/(c000+c001+c010+c011+c100+c101+c110+c111);
    p001=c001/(c000+c001+c010+c011+c100+c101+c110+c111);
    p010=c010/(c000+c001+c010+c011+c100+c101+c110+c111);
    p011=c011/(c000+c001+c010+c011+c100+c101+c110+c111);
    p100=c100/(c000+c001+c010+c011+c100+c101+c110+c111);
    p101=c101/(c000+c001+c010+c011+c100+c101+c110+c111);
    p110=c110/(c000+c001+c010+c011+c100+c101+c110+c111);
    p111=c111/(c000+c001+c010+c011+c100+c101+c110+c111);
    %     if p000==0 p000=1;end
    %     if p001==0 p001=1;end
    %     if p010==0 p010=1;end
    %     if p011==0 p011=1;end
    %     if p100==0 p100=1;end
    %     if p101==0 p101=1;end
    %     if p110==0 p110=1;end
    %     if p111==0 p111=1;end
    %     H3SD(m)=-(p000*log2(p000)+p001*log2(p001)+p010*log2(p010)+p011*log2(p011)+p100*log2(p100)+p101*log2(p101)+p110*log2(p110)+p111*log2(p111));
    
    for n=1:(length(train)-3)
        if train(n:(n+3))==[0;0;0;0]
            c0000=c0000+1;
        elseif train(n:(n+3))==[0;0;0;1]
            c0001=c0001+1;
        elseif train(n:(n+3))==[0;0;1;0]
            c0010=c0010+1;
        elseif train(n:(n+3))==[0;0;1;1]
            c0011=c0011+1;
        elseif train(n:(n+3))==[0;1;0;0]
            c0100=c0100+1;
        elseif train(n:(n+3))==[0;1;0;1]
            c0101=c0101+1;
        elseif train(n:(n+3))==[0;1;1;0]
            c0110=c0110+1;
        elseif train(n:(n+3))==[0;1;1;1]
            c0111=c0111+1;
        elseif train(n:(n+3))==[1;0;0;0]
            c1000=c1000+1;
        elseif train(n:(n+3))==[1;0;0;1]
            c1001=c1001+1;
        elseif train(n:(n+3))==[1;0;1;0]
            c1010=c1010+1;
        elseif train(n:(n+3))==[1;0;1;1]
            c1011=c1011+1;
        elseif train(n:(n+3))==[1;1;0;0]
            c1100=c1100+1;
        elseif train(n:(n+3))==[1;1;0;1]
            c1101=c1101+1;
        elseif train(n:(n+3))==[1;1;1;0]
            c1110=c1110+1;
        elseif train(n:(n+3))==[1;1;1;1]
            c1111=c1111+1;
        end
    end
    
    p0000=c0000/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0001=c0001/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0010=c0010/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0011=c0011/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0100=c0100/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0101=c0101/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0110=c0110/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p0111=c0111/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1000=c1000/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1001=c1001/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1010=c1010/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1011=c1011/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1100=c1100/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1101=c1101/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1110=c1110/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    p1111=c1111/(c0000+c0001+c0010+c0011+c0100+c0101+c0110+c0111+c1000+c1001+c1010+c1011+c1100+c1101+c1110+c1111);
    
    %     if p0000==0 p0000=1;end
    %     if p0001==0 p0001=1;end
    %     if p0010==0 p0010=1;end
    %     if p0011==0 p0011=1;end
    %     if p0100==0 p0100=1;end
    %     if p0101==0 p0101=1;end
    %     if p0110==0 p0110=1;end
    %     if p0111==0 p0111=1;end
    %     if p1000==0 p1000=1;end
    %     if p1001==0 p1001=1;end
    %     if p1010==0 p1010=1;end
    %     if p1011==0 p1011=1;end
    %     if p1100==0 p1100=1;end
    %     if p1101==0 p1101=1;end
    %     if p1110==0 p1110=1;end
    %     if p1111==0 p1111=1;end
    %     H4SD(m)=-(p0000*log2(p0000)+p0001*log2(p0001)+p0010*log2(p0010)+p0011*log2(p0011)+p0100*log2(p0100)+p0101*log2(p0101)+p0110*log2(p0110)+p0111*log2(p0111)...
    %         +p1000*log2(p1000)+p1001*log2(p1001)+p1010*log2(p1010)+p1011*log2(p1011)+p1100*log2(p1100)+p1101*log2(p1101)+p1110*log2(p1110)+p1111*log2(p1111));
     H4SD(m)=-((p0000+p1000+p0001+p0111+p1110+p1111+p0011+p1100)*log2(p0000+p1000+p0001+p0111+p1110+p1111+p0011+p1100)...
         +(p0010+p0100+p0110+p1010+p0101+p1001+p1011+p1101)*log2(p0010+p0100+p0110+p1010+p0101+p1001+p1011+p1101));
end

% [t1,pvalue1]=ttest2(H1CO,H1SD);
% [t2,pvalue2]=ttest2(H2CO,H2SD);
% [t3,pvalue3]=ttest2(H3CO,H3SD);
[t4,pvalue4]=ttest2(H4CO,H4SD)
